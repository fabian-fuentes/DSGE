#install.packages("deSolve")
library("deSolve")
prob_6_3<- function(t, state, parameters) {
with(as.list(c(state,parameters)), {
#Endogenous variables
minimum.regeneration <- carrying.capacity*minimum.regeneration.rate
resource.dependent.regeneration <- regeneration.rate*
renewable.resources*
(renewable.resources/carrying.capacity)*
(1- renewable.resources/carrying.capacity)
resource.use <-
per.capita.renewable.resource.availability <- renewable.resources/population
resource.availability.dependent.lifetime <-max(c(15,min(c(100,normal.lifetime*per.capita.renewable.resource.availability))))
#Flow variables
regeneration <- minimum.regeneration + resource.dependent.regeneration
resource.use <- min(c(renewable.resources/rapid.resourcedepletion.time,renewable.resource.consumption.per.capita*population))
births <- population*per.capita.renewable.resource.availability*normal.birth.rate
deaths <- population/resource.availability.dependent.lifetime
#State Variables
drenewable.resources  <- regeneration - resource.use
dpopulation <- births - deaths
list(c(dpopulation,drenewable.resources),
births = births,
deaths= deaths,
regeneration = regeneration,
resource.use = resource.use)
})
}
parameters<-c(normal.birth.rate = 0.35/100, #[1/year.]
normal.lifetime = 75 , #[year]
regeneration.rate = 1.2,
carrying.capacity = 7.5, #[million units],
minimum.regeneration.rate = 1/100, #[1/year]
rapid.resourcedepletion.time = 1, #[year],
renewable.resource.consumption.per.capita = 1*0.75 #[unit/person*year]
)
InitialConditions <- c(population = 1,  # million person
renewable.resources = 5  # million units
)
times <- seq(0,500,0.5)
intg.method<-c("rk4")
out <- ode(y = InitialConditions,
times = times,
func = prob_6_3,
parms = parameters,
method =intg.method )
data_all <- list()
vector <- seq(0.5,1.5,by=0.1)
for (i in 1:length(vector))
{
#i<- 1
parameters_dummy<-c(normal.birth.rate = 0.35/100, #[1/year.]
normal.lifetime = 75 , #[year]
regeneration.rate = 1.2,
carrying.capacity = 7.5, #[million units],
minimum.regeneration.rate = 1/100, #[1/year]
rapid.resourcedepletion.time = 1, #[year],
renewable.resource.consumption.per.capita = 1*vector[i] #[unit/person*year]
)
out <- ode(y = InitialConditions,
times = times,
func = prob_6_3,
parms = parameters_dummy,
method =intg.method )
out <- data.frame(out)
out$Scalar <- vector[i]
data_all <- append(data_all,list(out))
}
data_all <- do.call("rbind",data_all)
View(data_all)
View(out)
#Habit formation analysis
library(gEcon)
#Habit formation analysis
install.packages(c("inline", "Rcpp", "gsl", "digest", "Matrix", "data.table", "igraph"))
install.packages("gEcon", repos = "http://R-Forge.R-project.org")
library(gEcon)
library(gEcon)
install.packages("gEcon", repos = NULL, type = "source")
install.packages("gEcon", repos = "http://R-Forge.R-project.org")
